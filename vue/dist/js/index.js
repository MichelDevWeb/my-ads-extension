(()=>{"use strict";var e={341:(e,t,o)=>{var c=o(751),a=o(641),n=o(33);const s={class:"app-container"},r={class:"main-content"},i={class:"account-section"},l={class:"select-container"},u={class:"select-wrapper"},d=["value"],m=["disabled"],h={key:0,class:"ads-accounts-section"},p={class:"section-header"},g={key:0,class:"table-container"},k={class:"ads-table"},A={key:1,class:"no-data"},w={key:1,class:"bulk-creation"},y={class:"creation-inputs"},f={class:"input-group"},v={class:"input-group"},C=["disabled"],L={key:2,class:"loading-overlay"},b={key:3,class:"error-message"},M={key:4,class:"creation-status"},F={key:5,class:"mcc-creation-section"},S={class:"mcc-form"},U={class:"form-row"},E={class:"form-group"},P={class:"input-group"},_={class:"form-group"},N={class:"form-row"},T={class:"form-group"},$={class:"form-group"},j={class:"form-actions"},D=["disabled"];function x(e,t,o,x,G,O){return(0,a.uX)(),(0,a.CE)("div",s,[t[39]||(t[39]=(0,a.Lk)("header",{class:"header"},[(0,a.Lk)("h1",null,"Google Accounts Manager")],-1)),(0,a.Lk)("main",r,[(0,a.Lk)("div",i,[(0,a.Lk)("div",l,[t[18]||(t[18]=(0,a.Lk)("label",{for:"accountSelect"},"Google Account:",-1)),(0,a.Lk)("div",u,[(0,a.bo)((0,a.Lk)("select",{id:"accountSelect","onUpdate:modelValue":t[0]||(t[0]=e=>G.selectedAccount=e),onChange:t[1]||(t[1]=(...e)=>O.handleAccountSelect&&O.handleAccountSelect(...e)),class:(0,n.C4)({empty:!G.selectedAccount})},[t[16]||(t[16]=(0,a.Lk)("option",{value:""},"Select Account",-1)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(G.accounts,(e=>((0,a.uX)(),(0,a.CE)("option",{key:e.id,value:e.email},(0,n.v_)(e.email),9,d)))),128))],34),[[c.u1,G.selectedAccount]]),(0,a.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>O.refreshGoogleAccounts&&O.refreshGoogleAccounts(...e)),class:"refresh-accounts-btn",disabled:G.loading},t[17]||(t[17]=[(0,a.Lk)("span",{class:"icon"},"â†»",-1)]),8,m)])]),(0,a.Lk)("button",{onClick:t[3]||(t[3]=(...e)=>O.addNewGoogleAccount&&O.addNewGoogleAccount(...e)),class:"add-btn"},t[19]||(t[19]=[(0,a.Lk)("span",{class:"icon"},"+",-1),(0,a.eW)(" Add New Account ")]))]),G.selectedAccount?((0,a.uX)(),(0,a.CE)("div",h,[(0,a.Lk)("div",p,[t[21]||(t[21]=(0,a.Lk)("h2",null,"Google Ads Accounts",-1)),(0,a.Lk)("button",{onClick:t[4]||(t[4]=(...e)=>O.refreshAdsAccounts&&O.refreshAdsAccounts(...e)),class:"refresh-btn"},t[20]||(t[20]=[(0,a.Lk)("span",{class:"icon"},"â†»",-1),(0,a.eW)(" Refresh ")]))]),G.adsAccounts.length?((0,a.uX)(),(0,a.CE)("div",g,[(0,a.Lk)("table",k,[t[22]||(t[22]=(0,a.Lk)("thead",null,[(0,a.Lk)("tr",null,[(0,a.Lk)("th",null,"Account Name"),(0,a.Lk)("th",null,"Account ID"),(0,a.Lk)("th",null,"Type"),(0,a.Lk)("th",null,"Status")])],-1)),(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(G.adsAccounts,(e=>((0,a.uX)(),(0,a.CE)("tr",{key:e.id},[(0,a.Lk)("td",null,(0,n.v_)(e.name),1),(0,a.Lk)("td",null,(0,n.v_)(e.id),1),(0,a.Lk)("td",null,[(0,a.Lk)("span",{class:(0,n.C4)(["badge",e.type.toLowerCase()])},(0,n.v_)(e.type),3)]),(0,a.Lk)("td",null,[(0,a.Lk)("span",{class:(0,n.C4)(["status",e.status.toLowerCase()])},(0,n.v_)(e.status),3)])])))),128))])])])):((0,a.uX)(),(0,a.CE)("div",A,[t[23]||(t[23]=(0,a.Lk)("div",{class:"no-data-icon"},"ðŸ“Š",-1)),t[24]||(t[24]=(0,a.Lk)("p",null,"No Google Ads accounts found for this email.",-1)),(0,a.Lk)("button",{onClick:t[5]||(t[5]=(...e)=>O.createBulkAccounts&&O.createBulkAccounts(...e)),class:"create-btn"}," Create New Accounts ")]))])):(0,a.Q3)("",!0),G.selectedAccount?((0,a.uX)(),(0,a.CE)("div",w,[t[27]||(t[27]=(0,a.Lk)("h2",null,"Bulk Account Creation",-1)),(0,a.Lk)("div",y,[(0,a.Lk)("div",f,[t[25]||(t[25]=(0,a.Lk)("label",null,"Number of MCC Accounts:",-1)),(0,a.bo)((0,a.Lk)("input",{type:"number","onUpdate:modelValue":t[6]||(t[6]=e=>G.numMccAccounts=e),min:"1",max:"20",class:"number-input"},null,512),[[c.Jo,G.numMccAccounts,void 0,{number:!0}]])]),(0,a.Lk)("div",v,[t[26]||(t[26]=(0,a.Lk)("label",null,"Children per MCC:",-1)),(0,a.bo)((0,a.Lk)("input",{type:"number","onUpdate:modelValue":t[7]||(t[7]=e=>G.numChildrenPerMcc=e),min:"1",max:"50",class:"number-input"},null,512),[[c.Jo,G.numChildrenPerMcc,void 0,{number:!0}]])]),(0,a.Lk)("button",{onClick:t[8]||(t[8]=(...e)=>O.createBulkAccounts&&O.createBulkAccounts(...e)),disabled:G.loading,class:"create-btn"},(0,n.v_)(G.loading?"Creating...":"Create Accounts"),9,C)])])):(0,a.Q3)("",!0),G.loading?((0,a.uX)(),(0,a.CE)("div",L,t[28]||(t[28]=[(0,a.Lk)("div",{class:"loading-spinner"},null,-1),(0,a.Lk)("p",null,"Processing...",-1)]))):(0,a.Q3)("",!0),G.error?((0,a.uX)(),(0,a.CE)("div",b,[t[29]||(t[29]=(0,a.Lk)("span",{class:"error-icon"},"âš ï¸",-1)),(0,a.eW)(" "+(0,n.v_)(G.error)+" ",1),(0,a.Lk)("button",{onClick:t[9]||(t[9]=e=>G.error=null),class:"close-btn"},"Ã—")])):(0,a.Q3)("",!0),G.creatingAccount?((0,a.uX)(),(0,a.CE)("div",M,t[30]||(t[30]=[(0,a.Lk)("div",{class:"status-message"},[(0,a.Lk)("span",{class:"spinner"}),(0,a.eW)(" Creating MCC Account... "),(0,a.Lk)("p",{class:"help-text"}," Please complete the account creation in the opened window ")],-1)]))):(0,a.Q3)("",!0),G.selectedAccount?((0,a.uX)(),(0,a.CE)("div",F,[t[38]||(t[38]=(0,a.Lk)("h3",null,"Create MCC Account",-1)),(0,a.Lk)("div",S,[(0,a.Lk)("div",U,[(0,a.Lk)("div",E,[t[31]||(t[31]=(0,a.Lk)("label",null,"Account Name:",-1)),(0,a.Lk)("div",P,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[10]||(t[10]=e=>G.mccForm.name=e),type:"text",readonly:""},null,512),[[c.Jo,G.mccForm.name]]),(0,a.Lk)("button",{onClick:t[11]||(t[11]=(...e)=>O.regenerateName&&O.regenerateName(...e)),class:"regenerate-btn",type:"button"}," â†» ")])]),(0,a.Lk)("div",_,[t[33]||(t[33]=(0,a.Lk)("label",null,"Currency:",-1)),(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t[12]||(t[12]=e=>G.mccForm.currency=e)},t[32]||(t[32]=[(0,a.Lk)("option",{value:"USD"},"USD",-1),(0,a.Lk)("option",{value:"EUR"},"EUR",-1),(0,a.Lk)("option",{value:"GBP"},"GBP",-1),(0,a.Lk)("option",{value:"HKD"},"HKD",-1)]),512),[[c.u1,G.mccForm.currency]])])]),(0,a.Lk)("div",N,[(0,a.Lk)("div",T,[t[35]||(t[35]=(0,a.Lk)("label",null,"Time Zone:",-1)),(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t[13]||(t[13]=e=>G.mccForm.timezone=e)},t[34]||(t[34]=[(0,a.Lk)("option",{value:"America/New_York"},"New York",-1),(0,a.Lk)("option",{value:"Asia/Hong_Kong"},"Hong Kong",-1),(0,a.Lk)("option",{value:"Europe/London"},"London",-1)]),512),[[c.u1,G.mccForm.timezone]])]),(0,a.Lk)("div",$,[t[37]||(t[37]=(0,a.Lk)("label",null,"Country:",-1)),(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t[14]||(t[14]=e=>G.mccForm.country=e)},t[36]||(t[36]=[(0,a.Lk)("option",{value:"US"},"United States",-1),(0,a.Lk)("option",{value:"HK"},"Hong Kong",-1),(0,a.Lk)("option",{value:"GB"},"United Kingdom",-1)]),512),[[c.u1,G.mccForm.country]])])]),(0,a.Lk)("div",j,[(0,a.Lk)("button",{onClick:t[15]||(t[15]=(...e)=>O.handleMccCreate&&O.handleMccCreate(...e)),disabled:G.creating,class:"create-btn"},(0,n.v_)(G.creating?"Creating...":"Create MCC Account"),9,D)])])])):(0,a.Q3)("",!0)])])}const G={name:"App",data(){return{accounts:[],selectedAccount:"",adsAccounts:[],numMccAccounts:1,numChildrenPerMcc:1,loading:!1,error:null,creatingAccount:!1,creating:!1,mccForm:{name:this.generateMccName(),currency:"USD",timezone:"America/New_York",country:"US"}}},methods:{async getAuthToken(){return new Promise(((e,t)=>{chrome.identity.getAuthToken({interactive:!0,scopes:["https://www.googleapis.com/auth/userinfo.email","https://www.googleapis.com/auth/userinfo.profile","https://www.googleapis.com/auth/adwords"]},(o=>{chrome.runtime.lastError?t(new Error(chrome.runtime.lastError.message)):e(o)}))}))},async refreshGoogleAccounts(){this.loading=!0,this.error=null;try{const e=await this.getAuthToken(),t=await this.getUserInfo(e);this.accounts.some((e=>e.email===t.email))||this.accounts.push({id:Date.now(),email:t.email,token:e}),this.selectedAccount||(this.selectedAccount=t.email,await this.handleAccountSelect())}catch(e){this.error="Failed to refresh Google account: "+e.message,console.error(e)}finally{this.loading=!1}},async getUserInfo(e){const t=await fetch("https://www.googleapis.com/oauth2/v2/userinfo",{headers:{Authorization:`Bearer ${e}`}});if(!t.ok)throw new Error("Failed to get user info");return t.json()},async handleAccountSelect(){if(this.selectedAccount){this.loading=!0;try{const e=await this.getAuthToken();await this.loadAdsAccounts(e)}catch(e){this.error=e.message}finally{this.loading=!1}}},async loadAdsAccounts(e){try{const t=await fetch("https://ads.google.com/aw/overview",{headers:{Authorization:`Bearer ${e}`,Accept:"application/json","Content-Type":"application/json"},credentials:"include"});if(t.ok){const e=await t.json();this.processAdsAccounts(e)}else{const t=await fetch("https://ads.google.com/aw/overview/customeraccounts",{headers:{Authorization:`Bearer ${e}`,Accept:"application/json"},credentials:"include"});if(t.ok){const e=await t.json();return void this.processAdsAccounts(e)}await this.loadAdsAccountsViaDeeplink(e)}}catch(t){console.error("Failed to load accounts:",t),await this.loadAdsAccountsViaDeeplink(e)}},async loadAdsAccountsViaDeeplink(e){try{const o={authuser:this.selectedAccount,hl:"en",__c:Date.now()},c=[`https://ads.google.com/aw/overview?${new URLSearchParams(o)}`,`https://ads.google.com/aw/accountspicker?${new URLSearchParams({...o,type:"MCCSearch",mccs:"true"})}`,`https://ads.google.com/aw/accounts?${new URLSearchParams({...o,view:"all"})}`,`https://ads.google.com/aw/overview?${new URLSearchParams({...o,mcc:"true"})}`];for(const a of c)try{const t=await fetch(a,{headers:{Authorization:`Bearer ${e}`,Accept:"application/json, text/html","X-Requested-With":"XMLHttpRequest"},credentials:"include"});if(t.ok){const e=t.headers.get("content-type");if(e?.includes("application/json")){const e=await t.json();if(this.processAdsAccounts(e))return}else if(e?.includes("text/html")){const e=await t.text();if(this.extractAccountsFromHtml(e))return}}}catch(t){console.warn(`Failed to load from ${a}:`,t);continue}throw new Error("Could not access Google Ads accounts")}catch(t){console.error("Deeplink access failed:",t),this.error="Failed to load Google Ads accounts. Please try again.",this.adsAccounts=[]}},processAdsAccounts(e){try{if(e.accounts||e.customerAccounts||e.mccs){const t=e.accounts||e.customerAccounts||e.mccs;return this.adsAccounts=t.map((e=>({id:e.customerId||e.id,name:e.name||e.descriptiveName||`Account ${e.customerId}`,type:e.accountType||(e.canManageClients?"MCC":"Child"),status:e.accountStatus||e.status||"Unknown"}))),!0}return!1}catch(t){return console.error("Failed to process accounts data:",t),!1}},extractAccountsFromHtml(e){try{const t=new DOMParser,o=t.parseFromString(e,"text/html"),c=o.querySelectorAll(["[data-customer-id]",".account-card",".customer-account","[data-account-id]"].join(","));return c.length>0&&(this.adsAccounts=Array.from(c).map((e=>({id:e.getAttribute("data-customer-id")||e.getAttribute("data-account-id"),name:e.querySelector(".account-name, .customer-name")?.textContent||"Unknown Account",type:e.hasAttribute("data-is-mcc")?"MCC":"Child",status:e.querySelector(".status")?.textContent||"Unknown"}))),!0)}catch(t){return console.error("Failed to extract accounts from HTML:",t),!1}},async createBulkAccounts(){this.loading=!0,this.error=null;try{const e=await this.getAuthToken();for(let t=0;t<this.numMccAccounts;t++){const t=await this.createMccAccount(e);console.log("Created MCC account:",t),await new Promise((e=>setTimeout(e,2e3)));for(let e=0;e<this.numChildrenPerMcc;e++);}await this.refreshAdsAccounts()}catch(e){this.error=e.message,console.error("Bulk creation error:",e)}finally{this.loading=!1}},async refreshAdsAccounts(){this.loading=!0;try{const e=await this.getAuthToken();await this.loadAdsAccounts(e)}catch(e){this.error=e.message}finally{this.loading=!1}},async addNewGoogleAccount(){this.loading=!0,this.error=null;try{const e=await new Promise(((e,t)=>{chrome.identity.getAuthToken({interactive:!0,scopes:["https://www.googleapis.com/auth/userinfo.email","https://www.googleapis.com/auth/userinfo.profile","https://www.googleapis.com/auth/adwords"]},(o=>{chrome.runtime.lastError?t(new Error(chrome.runtime.lastError.message)):e(o)}))})),t=await this.getUserInfo(e);this.accounts.some((e=>e.email===t.email))||this.accounts.push({id:Date.now(),email:t.email,token:e}),this.selectedAccount=t.email,await this.handleAccountSelect()}catch(e){this.error="Failed to add new Google account: "+e.message,console.error(e)}finally{this.loading=!1}},async handleMccCreate(){if(this.validateMccForm())try{this.creating=!0;const e=await this.getAuthToken();await this.createMccAccount(e)}catch(e){this.error=e.message}finally{this.creating=!1}},validateMccForm(){return!!this.mccForm.name||(this.error="Please enter an account name",!1)},async createMccAccount(e){try{const o=await this.getUserInfo(e),c=new URLSearchParams({authuser:o.email,descriptiveName:this.mccForm.name,currencyCode:this.mccForm.currency,timeZone:this.mccForm.timezone,country:this.mccForm.country,__c:Date.now(),hl:"en",mcc:"true"}),a=[{url:"https://ads.google.com/aw/overview/signup/mcc",method:"POST",params:c,body:{accountName:this.mccForm.name,currencyCode:this.mccForm.currency,timeZone:this.mccForm.timezone,country:this.mccForm.country,type:"MCC"}},{url:"https://ads.google.com/um/Welcome/Home",method:"POST",params:new URLSearchParams({...Object.fromEntries(c),step:"sign-up"}),body:{accountName:this.mccForm.name,currencyCode:this.mccForm.currency,timeZone:this.mccForm.timezone,country:this.mccForm.country}}];for(const n of a)try{const t=await fetch(`${n.url}?${n.params}`,{method:n.method,headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json",Accept:"application/json","x-goog-user-email":o.email},body:JSON.stringify(n.body),credentials:"include"});if(t.ok||302===t.status){await new Promise((e=>setTimeout(e,5e3)));const t=await fetch("https://ads.google.com/aw/overview",{headers:{Authorization:`Bearer ${e}`,Accept:"application/json","x-goog-user-email":o.email},credentials:"include"});if(t.ok)return await this.loadAdsAccounts(e),{status:"completed"}}}catch(t){console.warn(`Failed with endpoint ${n.url}:`,t);continue}throw new Error("Could not create MCC account automatically")}catch(t){throw console.error("Create MCC error:",t),t}},generateMccName(){const e=new Date,t=e.getTime(),o=e.toISOString().split("T")[0],c=[`MCC_${t}`,`MCC_${o}`,`MCC_${this.formatDate(e)}`,`MCC_${this.getRandomString(6)}`];return c[0]},formatDate(e){const t=e.getFullYear(),o=String(e.getMonth()+1).padStart(2,"0"),c=String(e.getDate()).padStart(2,"0");return`${t}${o}${c}`},getRandomString(e){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let o="";for(let c=0;c<e;c++)o+=t.charAt(Math.floor(Math.random()*t.length));return o},regenerateName(){this.mccForm.name=this.generateMccName()}}};var O=o(262);const B=(0,O.A)(G,[["render",x],["__scopeId","data-v-2b2c36e5"]]),X=B;(0,c.Ef)(X).mount("#app")}},t={};function o(c){var a=t[c];if(void 0!==a)return a.exports;var n=t[c]={exports:{}};return e[c](n,n.exports,o),n.exports}o.m=e,(()=>{var e=[];o.O=(t,c,a,n)=>{if(!c){var s=1/0;for(u=0;u<e.length;u++){for(var[c,a,n]=e[u],r=!0,i=0;i<c.length;i++)(!1&n||s>=n)&&Object.keys(o.O).every((e=>o.O[e](c[i])))?c.splice(i--,1):(r=!1,n<s&&(s=n));if(r){e.splice(u--,1);var l=a();void 0!==l&&(t=l)}}return t}n=n||0;for(var u=e.length;u>0&&e[u-1][2]>n;u--)e[u]=e[u-1];e[u]=[c,a,n]}})(),(()=>{o.d=(e,t)=>{for(var c in t)o.o(t,c)&&!o.o(e,c)&&Object.defineProperty(e,c,{enumerable:!0,get:t[c]})}})(),(()=>{o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()})(),(()=>{o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})(),(()=>{var e={57:0};o.O.j=t=>0===e[t];var t=(t,c)=>{var a,n,[s,r,i]=c,l=0;if(s.some((t=>0!==e[t]))){for(a in r)o.o(r,a)&&(o.m[a]=r[a]);if(i)var u=i(o)}for(t&&t(c);l<s.length;l++)n=s[l],o.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return o.O(u)},c=self["webpackChunkgoogle_accounts_manager"]=self["webpackChunkgoogle_accounts_manager"]||[];c.forEach(t.bind(null,0)),c.push=t.bind(null,c.push.bind(c))})();var c=o.O(void 0,[504],(()=>o(341)));c=o.O(c)})();